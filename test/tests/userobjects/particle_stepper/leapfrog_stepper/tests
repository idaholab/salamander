[Tests]
  design = 'ParticleStepperBase.md PICStudyBase.md'
  issues = '#4 #19 #23'
  [circular_e_field]
    requirement = 'The system shall be capable of accurately capturing the path of charged particles in a time varrying electric field'
    [convergence]
      type = PythonUnitTest
      input = 'test.py'
      heavy = True
      test_case = LeapFrogCyclotronElectricTest
      required_python_packages = 'pandas matplotlib'
      installation_type = in_tree
    []
    [convergence_errors]
      type = 'CSVDiff'
      input = 'test.py'
      heavy = True
      csvdiff = 'circular_e_field_errors.csv'
      should_execute = False
      prereq = 'circular_e_field/convergence'
    []
    [convergence_orders]
      type = 'CSVDiff'
      input = 'test.py'
      heavy = True
      csvdiff = 'circular_e_field_orders.csv'
      should_execute = False
      prereq = 'circular_e_field/convergence'
    []
    [fields]
      type = 'Exodiff'
      input = 'circular_e_field.i'
      exodiff = 'circular_e_field_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'circular_e_field.i'
      csvdiff = 'circular_e_field_csv_particle_data.csv'
      should_execute = False
      prereq = 'circular_e_field/fields'
      detail = 'and verify particle motion'
    []
  []
  [projectile_motion]
    requirement = "The system shall be capable of applying a linear impulse from a force field perpendicular to a particle\'s initial velocity"
    [fields]
      type = 'Exodiff'
      input = 'projectile_motion.i'
      exodiff = 'projectile_motion_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'projectile_motion.i'
      csvdiff = 'projectile_motion_csv_particle_data.csv'
      should_execute = False
      prereq = 'projectile_motion/fields'
      detail = 'and verify particle motion'
    []
  []
  [parallel_acceleration]
    requirement = "The system shall be capable of applying a linear impulse from a force field parallel to a particle's velocity"
    [fields]
      type = 'Exodiff'
      input = 'parallel_acceleration.i'
      exodiff = 'parallel_acceleration_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'parallel_acceleration.i'
      csvdiff = 'parallel_acceleration_csv_particle_data.csv'
      should_execute = False
      prereq = 'parallel_acceleration/fields'
      detail = 'and verify particle motion'
    []
  []
  [errors]
    requirement = 'The system shall report a reasonable error from the particle stepper when'

    [too_few_field_components]
      type = RunException
      input = 'parallel_acceleration.i'
      cli_args = "UserObjects/stepper/field_components='Ex'"
      allow_test_objects = true
      detail = 'the user does not provide 3 components of the force field'
      expect_err = 'You must provide 3 components representing the force field'
    []
  []
[]
