[Tests]
  design = 'ParticleStepperBase.md PICStudyBase.md'
  issues = '#4 #19 #23'
  [e_cross_b]
    requirement = 'The system shall be capable of accurately capturing the path of charged particles in both an electric and a magnetic field'
    [fields]
      type = 'Exodiff'
      input = 'e_cross_b.i'
      exodiff = 'e_cross_b_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'e_cross_b.i'
      csvdiff = 'e_cross_b_csv_particle_data.csv'
      should_execute = False
      prereq = 'e_cross_b/fields'
      detail = 'and verify particle motion'
    []
  []
  [cyclotron_motion]
    requirement = 'The system shall be capable of accurately capturing the path of charged particles in a perpendicular magnetic field'
    [convergence]
      type = PythonUnitTest
      input = 'test.py'
      heavy = True
      test_case = BorisCyclotronMagneticTest
      required_python_packages = 'pandas matplotlib'
      installation_type = in_tree
    []
    [convergence_errors]
      type = 'CSVDiff'
      input = 'test.py'
      heavy = True
      csvdiff = 'cyclotron_motion_errors.csv'
      should_execute = False
      prereq = 'cyclotron_motion/convergence'
    []
    [convergence_orders]
      type = 'CSVDiff'
      input = 'test.py'
      heavy = True
      csvdiff = 'cyclotron_motion_orders.csv'
      should_execute = False
      prereq = 'cyclotron_motion/convergence'
    []
    [fields]
      type = 'Exodiff'
      input = 'cyclotron_motion.i'
      exodiff = 'cyclotron_motion_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'cyclotron_motion.i'
      csvdiff = 'cyclotron_motion_csv_particle_data.csv'
      should_execute = False
      prereq = 'cyclotron_motion/fields'
      detail = 'and verify particle motion'
    []
  []
  [circular_e_field]
    requirement = 'The system shall be capable of accurately capturing the path of charged particles in a time varrying electric field'
    [convergence]
      type = PythonUnitTest
      input = 'test.py'
      heavy = True
      test_case = BorisCyclotronElectricTest
      required_python_packages = 'pandas matplotlib'
      installation_type = in_tree
    []
    [convergence_errors]
      type = 'CSVDiff'
      input = 'test.py'
      heavy = True
      csvdiff = 'circular_e_field_errors.csv'
      should_execute = False
      prereq = 'circular_e_field/convergence'
    []
    [convergence_orders]
      type = 'CSVDiff'
      input = 'test.py'
      heavy = True
      csvdiff = 'circular_e_field_orders.csv'
      should_execute = False
      prereq = 'circular_e_field/convergence'
    []
    [fields]
      type = 'Exodiff'
      input = 'circular_e_field.i'
      exodiff = 'circular_e_field_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'circular_e_field.i'
      csvdiff = 'circular_e_field_csv_particle_data.csv'
      should_execute = False
      prereq = 'circular_e_field/fields'
      detail = 'and verify particle motion'
    []
  []
  [projectile_motion]
    requirement = 'The system shall be capable of applying a linear impluse from a force field perpendicular to a particles initial velocity using the boris stepper when there is 0 magnetic field'
    [fields]
      type = 'Exodiff'
      input = 'projectile_motion.i'
      exodiff = 'projectile_motion_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'projectile_motion.i'
      csvdiff = 'projectile_motion_csv_particle_data.csv'
      should_execute = False
      prereq = 'projectile_motion/fields'
      detail = 'and verify particle motion'
    []
  []
  [parallel_acceleration]
    requirement = 'The system shall be capable of applying a linear impluse from a force field parallel to a particles velocity using the boris stepper when there is 0 magnetic field'
    [fields]
      type = 'Exodiff'
      input = 'parallel_acceleration.i'
      exodiff = 'parallel_acceleration_out.e'
      allow_test_objects = true
      detail = 'and verify the field'
    []
    [particle]
      type = 'CSVDiff'
      input = 'parallel_acceleration.i'
      csvdiff = 'parallel_acceleration_csv_particle_data.csv'
      should_execute = False
      prereq = 'parallel_acceleration/fields'
      detail = 'and verify particle motion'
    []
  []
  [errors]
    requirement = 'The system shall report a reasonable error from the particle stepper when'

    [too_few_efield_components]
      type = RunException
      input = 'cyclotron_motion.i'
      cli_args = "UserObjects/stepper/efield_components='Ex'"
      allow_test_objects = true
      detail = 'the user does not provide 3 components of the electric field'
      expect_err = 'You must provide 3 components representing the electric field'
    []

    [too_few_bfield_components]
      type = RunException
      input = 'cyclotron_motion.i'
      cli_args = "UserObjects/stepper/bfield_components='Bx'"
      allow_test_objects = true
      detail = 'the user does not provide 3 components of the magnetic field'
      expect_err = 'You must provide 3 components representing the magnetic field'
    []
  []
[]
